{% extends 'base.html' %}
{% block content %}
  {% if request.query_params.get('oauth_error') %}
    <p style="background:#fff1f0;border:1px solid #ffa39e;padding:.75rem;border-radius:.4rem;">Sign-in failed during token exchange. Please try again. If this persists, verify your redirect URI in Yoto developer settings matches this site exactly.</p>
  {% endif %}

  {% if installed %}
    <p style="background:#e6ffed;border:1px solid #b7eb8f;padding:.75rem;border-radius:.4rem;">Installation complete. You are signed in.</p>
  {% endif %}

  {% if user %}
    <p>You're signed in. Manage your <a href="/settings">Settings</a>, or trigger a build now.</p>
    <p><a class="btn" href="/rebuild">Rebuild todayâ€™s chapter</a></p>
    <p><a href="/auth/test">Run OAuth client-side test</a></p>
  {% else %}
    <p>Install the "Today in History" Yoto card to your account and set your preferences. Builds run daily at 06:00 in your timezone.</p>
    <p><a class="btn" href="/install">Install with Yoto</a></p>
    <p>After installing, visit <a href="/settings">Settings</a> to choose language, timezone, and age band.</p>
    <p style="margin-top:1rem"><a href="/auth/test">Having issues? Try the OAuth client-side test</a></p>
  {% endif %}
{% endblock %}
